(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";e.s(["default",()=>m],52683);var t=e.i(43476),s=e.i(71645);let a="macau-spending-rewards-awards",r=()=>{try{let e=localStorage.getItem(a);if(!e)return[];return JSON.parse(e).map(e=>({...e,bank:e.bank||"螞蟻銀行（澳門）股份有限公司",isThankYou:void 0!==e.isThankYou?e.isThankYou:0===e.value}))}catch(e){return console.error("Error loading awards from localStorage:",e),[]}},l=e=>{try{localStorage.setItem(a,JSON.stringify(e))}catch(e){console.error("Error saving awards to localStorage:",e)}},d=e=>{let t=r(),s={...e,id:Date.now().toString()+Math.random().toString(36).substr(2,9)};return t.push(s),l(t),s},n=(e,t)=>{let s=r(),a=s.findIndex(t=>t.id===e);return -1===a?null:(s[a]={...s[a],...t},l(s),s[a])},i=["螞蟻銀行（澳門）股份有限公司","中國銀行（澳門）股份有限公司","廣發銀行股份有限公司澳門分行","中國工商銀行（澳門）股份有限公司","澳門國際銀行股份有限公司","澳門通股份有限公司","大豐銀行股份有限公司","澳門極易付股份有限公司"];function c(e){let{award:a,onSave:r,onCancel:l,existingAwards:d=[]}=e,n=()=>({value:10,drawDate:"",expiryDate:"",redeemed:!1,redeemedDate:"",merchant:"",notes:"",bank:i[0],isThankYou:!1}),c=(0,s.useCallback)(e=>{let t=new Date,s=new Date(t),a=t.getDay();0===a?s.setDate(t.getDate()+1):6===a&&s.setDate(t.getDate()+2);let r=s.toISOString().split("T")[0],l=n();return l.drawDate=r,l.expiryDate=w(r),e&&(l.bank=e),l},[]),[o,x]=(0,s.useState)([n()]),[m,u]=(0,s.useState)([""]),[g,h]=(0,s.useState)([]),[b,p]=(0,s.useState)(null),[j,v]=(0,s.useState)(-1),y=(0,s.useCallback)(()=>d.map(e=>e.merchant).filter(e=>void 0!==e&&""!==e.trim()).filter((e,t,s)=>s.indexOf(e)===t).sort(),[d]);(0,s.useEffect)(()=>{h(y())},[y]);let f=(e,t)=>{let s=[...o];s[e]={...s[e],merchant:t},x(s),p(null)},N=e=>e?g.filter(t=>t.toLowerCase().includes(e.toLowerCase())).slice(0,5):[],w=e=>{let t=new Date(e),s=t.getDay(),a=0;a=0===s?7:6===s?1:7-s;let r=new Date(t);return r.setDate(t.getDate()+a),r.toISOString().split("T")[0]};(0,s.useEffect)(()=>{a?x([{value:a.value,drawDate:a.drawDate.split("T")[0],expiryDate:a.expiryDate.split("T")[0],redeemed:a.redeemed,redeemedDate:a.redeemedDate?a.redeemedDate.split("T")[0]:"",merchant:a.merchant||"",notes:a.notes||"",bank:a.bank||i[0],isThankYou:a.isThankYou||!1}]):x([c()]),u([""])},[a,c]);let k=(e,t,s)=>{let a=[...o];a[e]={...a[e],[t]:s},x(a)};return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md border max-w-4xl mx-auto",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:a?"編輯獎品":"新增獎品"}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),m.some(e=>e))return void alert("請修正日期錯誤後再提交");r(o.map(e=>({value:e.value,drawDate:new Date(e.drawDate).toISOString(),expiryDate:new Date(e.expiryDate).toISOString(),redeemed:e.redeemed,redeemedDate:e.redeemed&&e.redeemedDate?new Date(e.redeemedDate).toISOString():void 0,merchant:e.merchant||void 0,notes:e.notes||void 0,bank:e.bank,isThankYou:e.isThankYou})))},className:"space-y-6",children:[o.map((e,s)=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 relative",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-700",children:["獎品 ",s+1,e.isThankYou&&(0,t.jsx)("span",{className:"ml-2 text-orange-600 font-normal",children:"(謝謝惠顧)"})]}),o.length>1&&(0,t.jsx)("button",{type:"button",onClick:()=>(e=>{if(o.length>1){let t=o.filter((t,s)=>s!==e),s=m.filter((t,s)=>s!==e);x(t),u(s)}})(s),className:"text-red-500 hover:text-red-700 text-sm",children:"移除"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"獎品面值 (MOP)"}),(0,t.jsxs)("select",{value:e.value,onChange:e=>((e,t)=>{let s=[...o];s[e]={...s[e],value:t,isThankYou:0===t},x(s)})(s,parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,t.jsx)("option",{value:0,children:"謝謝惠顧"}),(0,t.jsx)("option",{value:10,children:"10 MOP"}),(0,t.jsx)("option",{value:20,children:"20 MOP"}),(0,t.jsx)("option",{value:50,children:"50 MOP"}),(0,t.jsx)("option",{value:100,children:"100 MOP"}),(0,t.jsx)("option",{value:200,children:"200 MOP"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"承辦單位"}),(0,t.jsx)("select",{value:e.bank,onChange:e=>k(s,"bank",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:i.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"抽獎日期"}),(0,t.jsx)("input",{type:"date",value:e.drawDate,onChange:e=>((e,t)=>{let s=(e=>{let t=new Date(e).getDay();return 0!==t&&6!==t})(t),a=[...m];a[e]=s?"":"抽獎日期不能是星期六或星期日",u(a);let r=w(t),l=[...o];l[e]={...l[e],drawDate:t,expiryDate:r},x(l)})(s,e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(m[s]?"border-red-500":"border-gray-300"),required:!0}),m[s]&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:m[s]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"到期日期"}),(0,t.jsx)("input",{type:"date",value:e.expiryDate,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 cursor-not-allowed",title:"到期日期根據抽獎日期自動計算"}),(0,t.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"根據抽獎日期自動計算"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"商戶名稱"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",value:e.merchant,onChange:e=>((e,t)=>{let s=[...o];s[e]={...s[e],merchant:t},x(s),p(t.length>0&&g.length>0?e:null),v(-1)})(s,e.target.value),onKeyDown:e=>((e,t)=>{let s=N(o[e].merchant);if(b&&0!==s.length)switch(t.key){case"ArrowDown":t.preventDefault(),v(e=>e<s.length-1?e+1:0);break;case"ArrowUp":t.preventDefault(),v(e=>e>0?e-1:s.length-1);break;case"Enter":t.preventDefault(),j>=0&&j<s.length&&f(e,s[j]);break;case"Escape":p(null),v(-1)}})(s,e),onFocus:()=>{e.merchant&&g.length>0&&p(s)},onBlur:()=>{setTimeout(()=>{p(null),v(-1)},200)},placeholder:"可選",className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),g.length>0&&(0,t.jsx)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-400 pointer-events-none",children:"💡"})]}),b===s&&(0,t.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-40 overflow-y-auto",children:N(e.merchant).length>0?N(e.merchant).map((e,a)=>(0,t.jsx)("div",{onClick:()=>f(s,e),className:"px-3 py-2 cursor-pointer text-sm border-b border-gray-100 last:border-b-0 ".concat(a===j?"bg-blue-100 text-blue-900":"hover:bg-gray-100"),children:e},a)):e.merchant&&(0,t.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:"無匹配的商戶建議"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"備註"}),(0,t.jsx)("input",{type:"text",value:e.notes,onChange:e=>k(s,"notes",e.target.value),placeholder:"可選",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-4",children:[(0,t.jsx)("input",{type:"checkbox",id:"redeemed-".concat(s),checked:e.redeemed,onChange:e=>k(s,"redeemed",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,t.jsx)("label",{htmlFor:"redeemed-".concat(s),className:"text-sm font-medium text-gray-700",children:"已兌換"})]}),e.redeemed&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"兌換日期"}),(0,t.jsx)("input",{type:"date",value:e.redeemedDate,onChange:e=>k(s,"redeemedDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:e.redeemed})]})]},s)),o.length>=1&&!a&&(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("button",{type:"button",onClick:()=>{let e=o[o.length-1];x([...o,c(e?e.bank:void 0)]),u([...m,""])},className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors",children:"+ 添加另一個獎品"})}),(0,t.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:m.some(e=>e),className:"px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ".concat(m.some(e=>e)?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:a?"更新":"新增 ".concat(o.length," 個獎品")}),(0,t.jsx)("button",{type:"button",onClick:l,className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors",children:"取消"})]})]})]})}function o(e){let{awards:a,onEdit:r,onDelete:l,onToggleRedeemed:d,onUpdateMerchant:n}=e,[i,c]=(0,s.useState)("date"),[o,x]=(0,s.useState)("desc"),[m,u]=(0,s.useState)("pending"),[g,h]=(0,s.useState)(""),[b,p]=(0,s.useState)(null),[j,v]=(0,s.useState)(""),[y,f]=(0,s.useState)(!1),[N,w]=(0,s.useState)(-1),k=(0,s.useCallback)(()=>a.map(e=>e.merchant).filter(e=>void 0!==e&&""!==e.trim()).filter((e,t,s)=>s.indexOf(e)===t).sort(),[a])(),D=e=>e?k.filter(t=>t.toLowerCase().includes(e.toLowerCase())).slice(0,5):[],A=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}),S=e=>!e.redeemed&&new Date(e.expiryDate)<new Date,O=a.filter(e=>{switch(m){case"pending":if(e.redeemed)return!1;break;case"redeemed":if(!e.redeemed)return!1;break;case"expired":if(!S(e))return!1}if(g){var t,s;let a=g.toLowerCase(),r=null==(t=e.merchant)?void 0:t.toLowerCase().includes(a),l=e.bank.toLowerCase().includes(a),d=null==(s=e.notes)?void 0:s.toLowerCase().includes(a),n=e.value.toString().includes(g);if(!r&&!l&&!d&&!n)return!1}return!0}).sort((e,t)=>{let s=0;switch(i){case"date":s=new Date(t.drawDate).getTime()-new Date(e.drawDate).getTime();break;case"value":s=t.value-e.value;break;case"status":s=e.redeemed===t.redeemed?new Date(t.drawDate).getTime()-new Date(e.drawDate).getTime():e.redeemed?1:-1;break;case"bank":s=e.bank.localeCompare(t.bank);break;case"merchant":let a=e.merchant||"",r=t.merchant||"";s=a.localeCompare(r);break;case"expiry":s=new Date(e.expiryDate).getTime()-new Date(t.expiryDate).getTime();break;default:s=0}return"asc"===o?s:-s}),C=e=>{let t=D(j);if(y&&0!==t.length)switch(e.key){case"ArrowDown":e.preventDefault(),w(e=>e<t.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),w(e=>e>0?e-1:t.length-1);break;case"Enter":e.preventDefault(),N>=0&&N<t.length&&M(t[N]);break;case"Escape":f(!1),w(-1)}},M=e=>{v(e),f(!1),w(-1)},V=()=>{p(null),v(""),f(!1),w(-1)};return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md border",children:[(0,t.jsx)("div",{className:"p-4 border-b",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"獎品記錄"}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["顯示 ",O.length," / ",a.length," 筆記錄"]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",placeholder:"搜索商戶、銀行、備註或面值...",value:g,onChange:e=>h(e.target.value),className:"px-3 py-1 pr-8 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),g&&(0,t.jsx)("button",{onClick:()=>h(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 text-sm",title:"清除搜索",children:"✕"})]}),(0,t.jsxs)("select",{value:m,onChange:e=>u(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"all",children:"全部"}),(0,t.jsx)("option",{value:"pending",children:"待兌換"}),(0,t.jsx)("option",{value:"redeemed",children:"已兌換"}),(0,t.jsx)("option",{value:"expired",children:"已過期"})]}),(0,t.jsxs)("select",{value:i,onChange:e=>c(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"date",children:"按日期排序"}),(0,t.jsx)("option",{value:"value",children:"按面值排序"}),(0,t.jsx)("option",{value:"status",children:"按狀態排序"}),(0,t.jsx)("option",{value:"bank",children:"按銀行排序"}),(0,t.jsx)("option",{value:"merchant",children:"按商戶排序"}),(0,t.jsx)("option",{value:"expiry",children:"按到期日期排序"})]}),(0,t.jsx)("button",{onClick:()=>x("asc"===o?"desc":"asc"),className:"px-3 py-1 border border-gray-300 rounded-md text-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"切換排序順序 (".concat("asc"===o?"升序":"降序",")"),children:"asc"===o?"↑":"↓"})]})]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:0===O.length?(0,t.jsx)("div",{className:"p-8 text-center text-gray-500",children:"all"===m?"還沒有記錄任何獎品":"沒有符合條件的獎品"}):(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"面值"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"承辦單位"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"抽獎日期"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"到期日期"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"商戶"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"狀態"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.isThankYou?(0,t.jsx)("span",{className:"text-orange-600 font-semibold",children:"謝謝惠顧"}):"".concat(e.value," MOP")})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:e.bank,children:e.bank})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm text-gray-900",children:A(e.drawDate)})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm ".concat(S(e)?"text-red-600 font-medium":"text-gray-900"),children:A(e.expiryDate)})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:b===e.id?(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)("input",{type:"text",value:j,onChange:e=>{var t;v(t=e.target.value),f(t.length>0&&k.length>0),w(-1)},onKeyDown:C,onFocus:()=>{j&&k.length>0&&f(!0)},onBlur:()=>{setTimeout(()=>{f(!1),w(-1)},200)},className:"text-sm border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full",placeholder:"輸入商戶名稱",autoFocus:!0}),k.length>0&&(0,t.jsx)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-400 pointer-events-none",children:"💡"}),y&&(0,t.jsx)("div",{className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-32 overflow-y-auto",children:D(j).length>0?D(j).map((e,s)=>(0,t.jsx)("div",{onClick:()=>M(e),className:"px-3 py-2 cursor-pointer text-sm border-b border-gray-100 last:border-b-0 ".concat(s===N?"bg-blue-100 text-blue-900":"hover:bg-gray-100"),children:e},s)):j&&(0,t.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500",children:"無匹配的商戶建議"})})]}),(0,t.jsx)("button",{onClick:()=>{n(e.id,j.trim()||void 0),p(null),v(""),f(!1),w(-1)},className:"text-green-600 hover:text-green-800 text-sm",title:"保存",children:"✓"}),(0,t.jsx)("button",{onClick:V,className:"text-red-600 hover:text-red-800 text-sm",title:"取消",children:"✕"})]})}):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-900",children:e.merchant||"-"}),(0,t.jsx)("button",{onClick:()=>{p(e.id),v(e.merchant||""),f(!1),w(-1)},className:"text-blue-600 hover:text-blue-800 text-sm",title:"編輯商戶",children:"✏️"})]})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:e.redeemed?(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"已兌換"}):S(e)?(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-red-100 text-red-800 rounded-full",children:"已過期"}):(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"待兌換"})}),(0,t.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[(0,t.jsx)("button",{onClick:()=>d(e.id),className:"px-2 py-1 rounded text-xs ".concat(e.redeemed?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-green-100 text-green-700 hover:bg-green-200"),children:e.redeemed?"取消兌換":"標記兌換"}),(0,t.jsx)("button",{onClick:()=>r(e),className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs hover:bg-blue-200",children:"編輯"}),(0,t.jsx)("button",{onClick:()=>l(e.id),className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs hover:bg-red-200",children:"刪除"})]})]},e.id))})]})})]})}function x(e){let{summary:s}=e,a=e=>"".concat(e.toLocaleString()," MOP"),r=(e,t)=>t>0?Math.round(e/t*100):0;return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md border",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-6 text-gray-800",children:"獎品統計"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:s.totalAwards}),(0,t.jsx)("div",{className:"text-sm text-blue-800",children:"總獎品數"})]}),(0,t.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:s.redeemedAwards}),(0,t.jsx)("div",{className:"text-sm text-green-800",children:"已兌換"}),(0,t.jsxs)("div",{className:"text-xs text-green-600 mt-1",children:[r(s.redeemedAwards,s.totalAwards),"%"]})]}),(0,t.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:s.pendingAwards}),(0,t.jsx)("div",{className:"text-sm text-yellow-800",children:"待兌換"})]}),(0,t.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:s.expiredAwards}),(0,t.jsx)("div",{className:"text-sm text-red-800",children:"已過期"})]})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg mb-6 border border-blue-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center",children:"💰 價值統計總覽"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"text-center bg-white p-4 rounded-lg shadow-sm",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-blue-600",children:a(s.totalValue)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"總價值"})]}),(0,t.jsxs)("div",{className:"text-center bg-white p-4 rounded-lg shadow-sm",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-green-600",children:a(s.redeemedValue)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"已兌換價值"})]}),(0,t.jsxs)("div",{className:"text-center bg-white p-4 rounded-lg shadow-sm",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-yellow-600",children:a(s.pendingValue)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"待兌換價值"})]}),(0,t.jsxs)("div",{className:"text-center bg-white p-4 rounded-lg shadow-sm",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-red-600",children:a(s.expiredValue)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"已過期價值"})]})]})]}),s.totalAwards>0&&(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"🎯 兌換進度"}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-6 mb-3",children:(0,t.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-6 rounded-full transition-all duration-500 flex items-center justify-center text-white text-sm font-medium",style:{width:"".concat(r(s.redeemedAwards,s.totalAwards),"%")},children:[r(s.redeemedAwards,s.totalAwards),"%"]})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-800 mb-1",children:[s.redeemedAwards," / ",s.totalAwards]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"獎品已兌換"})]})]}),s.topBigAwardBanks.length>0&&(0,t.jsxs)("div",{className:"border-t pt-6 mt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"🏆 大獎機率最高的銀行 TOP 3"}),(0,t.jsx)("div",{className:"space-y-3",children:s.topBigAwardBanks.map((e,s)=>(0,t.jsx)("div",{className:"p-4 rounded-lg border-2 ".concat(0===s?"bg-gradient-to-r from-yellow-50 to-yellow-100 border-yellow-300":1===s?"bg-gradient-to-r from-gray-50 to-gray-100 border-gray-300":"bg-gradient-to-r from-orange-50 to-orange-100 border-orange-300"),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold ".concat(0===s?"bg-yellow-400 text-yellow-900 shadow-lg":1===s?"bg-gray-400 text-white shadow-lg":"bg-orange-400 text-orange-900 shadow-lg"),children:s+1}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold text-gray-800 truncate max-w-xs",title:e.bank,children:e.bank}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["大獎機率: ",(0,t.jsxs)("span",{className:"font-bold text-green-600",children:[e.probability,"%"]})]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-xl font-bold text-gray-800",children:[e.bigAwards,"/",e.totalAwards]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[e.bigAwardValue," MOP"]})]})]})},e.bank))})]}),(0,t.jsxs)("div",{className:"border-t pt-6 mt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"📊 銀行獎品詳情"}),(0,t.jsx)("div",{className:"space-y-4",children:i.map(e=>{let a=s.bankValueDistribution[e];if(!a||0===a.totalAwards)return null;let r=a.bigAwards>0;return(0,t.jsxs)("div",{className:"border rounded-lg p-4 ".concat(r?"border-yellow-300 bg-yellow-50":"border-gray-200 bg-white"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-800 truncate",title:e,children:e}),r&&(0,t.jsx)("span",{className:"text-yellow-600",children:"🎯"})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["總計: ",(0,t.jsx)("span",{className:"font-bold",children:a.totalAwards})," 獎品"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2 mb-3",children:[0,10,20,50,100,200].map(e=>{let s=a.valueBreakdown[e]||0,r=a.totalAwards>0?s/a.totalAwards*100:0;return(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-sm font-medium px-2 py-2 rounded-lg ".concat(0===e?"bg-orange-100 text-orange-800 border border-orange-200":e>=100?"bg-green-100 text-green-800 border border-green-200":"bg-blue-100 text-blue-800 border border-blue-200"),children:0===e?"謝謝惠顧":"".concat(e,"MOP")}),(0,t.jsxs)("div",{className:"text-xs text-gray-600 mt-1 font-medium",children:[s," (",Math.round(r),"%)"]})]},e)})}),(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm border-t pt-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:["大獎機率: ",(0,t.jsxs)("span",{className:"font-bold ".concat(r?"text-green-600":"text-gray-500"),children:[Math.round(100*a.probability)/100,"%"]})]}),(0,t.jsxs)("span",{className:"text-gray-600",children:["總價值: ",(0,t.jsxs)("span",{className:"font-bold text-blue-600",children:[a.totalValue," MOP"]})]})]}),r&&(0,t.jsx)("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"大獎銀行"})]})]},e)})})]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"💰 面值統計詳情"}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"text-md font-medium mb-3 text-gray-700",children:"總體面值分佈"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3",children:[0,10,20,50,100,200].map(e=>{let a=s.valueDistribution[e]||0,r=s.totalAwards>0?a/s.totalAwards*100:0;return(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("div",{className:"p-3 rounded-lg border-2 ".concat(0===e?"bg-orange-50 border-orange-200":e>=100?"bg-green-50 border-green-200":"bg-blue-50 border-blue-200"),children:[(0,t.jsx)("div",{className:"text-lg font-bold text-gray-800",children:a}),(0,t.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:0===e?"謝謝惠顧":"".concat(e," MOP")}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[Math.round(r),"%"]})]})},e)})})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("h4",{className:"text-md font-medium mb-3 text-gray-700 flex items-center",children:["兌換狀態詳情",(0,t.jsx)("span",{className:"ml-2 text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full",children:"智能分析"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[0,10,20,50,100,200].map(e=>{let a=s.detailedValueStats[e],r=a?a.total:0;if(0===r)return(0,t.jsx)("div",{className:"p-4 rounded-lg border border-gray-200 bg-gray-50 hover:bg-gray-100 transition-colors",children:(0,t.jsxs)("div",{className:"text-center text-gray-400",children:[(0,t.jsx)("div",{className:"font-medium text-lg mb-1",children:0===e?"謝謝惠顧":"".concat(e," MOP")}),(0,t.jsx)("div",{className:"text-sm",children:"無記錄"}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"尚未獲得此面值獎品"})]})},e);let l=a.redeemed/a.total*100,d=a.expired/a.total*100,n=a.pending/a.total*100;return(0,t.jsxs)("div",{className:"p-4 rounded-lg border-2 hover:shadow-md transition-all duration-200 ".concat(0===e?"bg-orange-50 border-orange-200 hover:border-orange-300":e>=100?"bg-green-50 border-green-200 hover:border-green-300":"bg-blue-50 border-blue-200 hover:border-blue-300"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("h5",{className:"font-semibold text-gray-800 text-lg",children:0===e?"謝謝惠顧":"".concat(e," MOP")}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("span",{className:"text-sm font-bold text-gray-600 bg-white px-2 py-1 rounded",children:r}),e>=100&&(0,t.jsx)("div",{className:"text-xs text-yellow-600 font-medium mt-1",children:"🎯 大獎"})]})]}),(0,t.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,t.jsx)("span",{className:"text-green-600 font-medium",children:"已兌換"}),(0,t.jsxs)("span",{className:"text-green-600",children:[a.redeemed," (",Math.round(l),"%)"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(l,"%")}})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,t.jsx)("span",{className:"text-yellow-600 font-medium",children:"待兌換"}),(0,t.jsxs)("span",{className:"text-yellow-600",children:[a.pending," (",Math.round(n),"%)"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(n,"%")}})})]}),a.expired>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,t.jsx)("span",{className:"text-red-600 font-medium",children:"已過期"}),(0,t.jsxs)("span",{className:"text-red-600",children:[a.expired," (",Math.round(d),"%)"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-red-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(d,"%")}})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,t.jsxs)("div",{className:"bg-white p-2 rounded text-center",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"總價值"}),(0,t.jsxs)("div",{className:"font-semibold text-blue-600",children:[a.totalValue," MOP"]})]}),(0,t.jsxs)("div",{className:"bg-white p-2 rounded text-center",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"平均價值"}),(0,t.jsxs)("div",{className:"font-semibold text-purple-600",children:[Math.round(a.totalValue/a.total)," MOP"]})]})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 pt-2",children:(0,t.jsxs)("div",{className:"text-xs text-gray-600 space-y-1",children:[l>=80&&(0,t.jsx)("div",{className:"text-green-600 font-medium",children:"✅ 兌換率優秀"}),l<50&&a.pending>0&&(0,t.jsx)("div",{className:"text-yellow-600 font-medium",children:"⚠️ 待兌換較多"}),d>20&&(0,t.jsx)("div",{className:"text-red-600 font-medium",children:"🚨 過期率偏高"}),a.total>=10&&(0,t.jsx)("div",{className:"text-blue-600 font-medium",children:"📊 樣本充足"})]})})]},e)})})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("h4",{className:"text-md font-medium mb-3 text-gray-700 flex items-center",children:["📊 進階分析",(0,t.jsx)("span",{className:"ml-2 text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full",children:"AI 洞察"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-4 rounded-lg border border-green-200",children:[(0,t.jsx)("h5",{className:"font-semibold text-green-800 mb-3 flex items-center",children:"🎯 兌換效率分析"}),(0,t.jsx)("div",{className:"space-y-2",children:(()=>{let e=Object.values(s.detailedValueStats).filter(e=>e.total>0).reduce((e,t)=>({redeemed:e.redeemed+t.redeemed,total:e.total+t.total,expired:e.expired+t.expired}),{redeemed:0,total:0,expired:0}),a=e.total>0?e.redeemed/e.total*100:0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"整體兌換率:"}),(0,t.jsxs)("span",{className:"font-bold text-green-600",children:[Math.round(a),"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,t.jsx)("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-500",style:{width:"".concat(a,"%")}})}),(0,t.jsx)("div",{className:"text-xs text-gray-600 mt-2",children:a>=80?"✅ 兌換效率優秀":a>=60?"⚠️ 兌換效率一般":"🚨 需改善兌換習慣"})]})})()})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-200",children:[(0,t.jsx)("h5",{className:"font-semibold text-blue-800 mb-3 flex items-center",children:"💎 價值表現分析"}),(0,t.jsx)("div",{className:"space-y-2",children:(()=>{let e=s.detailedValueStats[100]||{total:0,redeemed:0},a=s.detailedValueStats[200]||{total:0,redeemed:0},r=e.total+a.total,l=e.redeemed+a.redeemed,d=r>0?l/r*100:0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"大獎兌換率:"}),(0,t.jsxs)("span",{className:"font-bold text-blue-600",children:[Math.round(d),"%"]})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:["大獎數量: ",r," | 已兌換: ",l]}),(0,t.jsx)("div",{className:"text-xs text-gray-600 mt-2",children:d>=90?"🏆 大獎把握度極佳":d>=70?"✅ 大獎把握度良好":"💡 建議關注大獎到期日"})]})})()})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-pink-50 p-4 rounded-lg border border-red-200",children:[(0,t.jsx)("h5",{className:"font-semibold text-red-800 mb-3 flex items-center",children:"⚠️ 風險評估"}),(0,t.jsx)("div",{className:"space-y-2",children:(()=>{let e=Object.values(s.detailedValueStats).reduce((e,t)=>e+t.expired,0),a=Object.values(s.detailedValueStats).reduce((e,t)=>e+t.expired*(t.total>0?t.totalValue/t.total:0),0),r=e>10?"high":e>5?"medium":"low";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"過期獎品:"}),(0,t.jsxs)("span",{className:"font-bold text-red-600",children:[e," 個"]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"過期價值:"}),(0,t.jsxs)("span",{className:"font-bold text-red-600",children:[Math.round(a)," MOP"]})]}),(0,t.jsx)("div",{className:"text-xs text-gray-600 mt-2",children:"high"===r?"🚨 高風險 - 過期較多":"medium"===r?"⚠️ 中風險 - 注意到期日":"✅ 低風險 - 管理良好"})]})})()})]})]})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 p-4 rounded-lg border border-indigo-200",children:[(0,t.jsx)("h4",{className:"text-md font-medium mb-3 text-gray-700 flex items-center",children:"💡 行動建議"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(()=>{let e=[],a=Object.values(s.detailedValueStats).reduce((e,t)=>e+t.pending,0);a>0&&e.push({type:"pending",title:"待兌換獎品提醒",message:"您有 ".concat(a," 個獎品尚未兌換，建議安排時間前往兌換"),icon:"⏰",color:"yellow"});let r=Object.entries(s.detailedValueStats).filter(e=>{let[t,s]=e;return parseInt(t)>=100&&s.pending>0}).reduce((e,t)=>{let[s,a]=t;return e+a.pending*parseInt(s)},0);r>0&&e.push({type:"high-value",title:"大獎兌換提醒",message:"有價值 ".concat(r," MOP 的大獎尚未兌換，別錯過！"),icon:"🎯",color:"green"});let l=Object.values(s.detailedValueStats).reduce((e,t)=>({total:e.total+t.total,redeemed:e.redeemed+t.redeemed}),{total:0,redeemed:0});return(l.total>0?l.redeemed/l.total*100:0)<60&&e.push({type:"efficiency",title:"兌換效率提升",message:"您的兌換率偏低，建議設定提醒並定期檢查獎品到期日",icon:"📈",color:"blue"}),e.length>0?e.slice(0,4).map((e,s)=>(0,t.jsx)("div",{className:"p-3 rounded-lg border ".concat("yellow"===e.color?"bg-yellow-50 border-yellow-200":"green"===e.color?"bg-green-50 border-green-200":"blue"===e.color?"bg-blue-50 border-blue-200":"bg-gray-50 border-gray-200"),children:(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)("span",{className:"text-lg",children:e.icon}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"font-medium text-gray-800 text-sm",children:e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.message})]})]})},s)):(0,t.jsxs)("div",{className:"col-span-2 text-center py-4",children:[(0,t.jsx)("div",{className:"text-green-600 text-lg mb-2",children:"🎉"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"您的獎品管理狀況良好！"})]})})()})]})]}),(0,t.jsxs)("div",{className:"border-t pt-6 mt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"承辦單位分佈"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:i.map(e=>{let a=s.bankValueDistribution[e],r=a&&a.bigAwards>0;return(0,t.jsxs)("div",{className:"p-4 rounded-lg ".concat(r?"bg-yellow-50 border-2 border-yellow-300":"bg-gray-50"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-gray-800",children:s.bankDistribution[e]||0}),r&&(0,t.jsx)("span",{className:"text-yellow-600 text-sm font-semibold",children:"🎯"})]}),(0,t.jsx)("div",{className:"text-sm text-gray-600 truncate mb-2",title:e,children:e}),a&&(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,t.jsxs)("div",{children:["大獎: ",a.bigAwards," (",Math.round(100*a.probability)/100,"%)"]}),(0,t.jsxs)("div",{children:["總值: ",a.totalValue," MOP"]})]})]},e)})}),(0,t.jsx)("div",{className:"mt-4 text-sm text-gray-600",children:(0,t.jsxs)("span",{className:"inline-flex items-center",children:[(0,t.jsx)("span",{className:"w-3 h-3 bg-yellow-300 border border-yellow-600 rounded mr-2"}),"提供大獎 (≥100 MOP) 的銀行"]})})]})]})}function m(){let[e,a]=(0,s.useState)([]),[i,m]=(0,s.useState)(!1),[u,g]=(0,s.useState)(),[h,b]=(0,s.useState)("list");(0,s.useEffect)(()=>{a(r())},[]);let p=(()=>{let e=r(),t=e.length,s=e.filter(e=>e.redeemed).length,a=e.reduce((e,t)=>e+t.value,0),l=e.filter(e=>e.redeemed).reduce((e,t)=>e+t.value,0),d=e.reduce((e,t)=>(e[t.value]=(e[t.value]||0)+1,e),{}),n=e.reduce((e,t)=>(e[t.value]||(e[t.value]={total:0,redeemed:0,pending:0,expired:0,totalValue:0,redeemedValue:0,pendingValue:0}),e[t.value].total+=1,e[t.value].totalValue+=t.value,t.redeemed?(e[t.value].redeemed+=1,e[t.value].redeemedValue+=t.value):(e[t.value].pending+=1,e[t.value].pendingValue+=t.value,new Date(t.expiryDate)<new Date&&(e[t.value].expired+=1)),e),{}),i=e.reduce((e,t)=>(e[t.bank]=(e[t.bank]||0)+1,e),{}),c=e.reduce((e,t)=>(e[t.bank]||(e[t.bank]={totalAwards:0,valueBreakdown:{},bigAwards:0,totalValue:0,bigAwardValue:0,probability:0}),e[t.bank].totalAwards+=1,e[t.bank].valueBreakdown[t.value]=(e[t.bank].valueBreakdown[t.value]||0)+1,e[t.bank].totalValue+=t.value,t.value>=100&&(e[t.bank].bigAwards+=1,e[t.bank].bigAwardValue+=t.value),e),{});Object.keys(c).forEach(e=>{let t=c[e];t.probability=t.totalAwards>0?t.bigAwards/t.totalAwards*100:0});let o=Object.entries(c).filter(e=>{let[,t]=e;return t.totalAwards>0}).sort((e,t)=>t[1].probability!==e[1].probability?t[1].probability-e[1].probability:t[1].bigAwards-e[1].bigAwards).slice(0,3).map(e=>{let[t,s]=e;return{bank:t,probability:Math.round(100*s.probability)/100,bigAwards:s.bigAwards,totalAwards:s.totalAwards,bigAwardValue:s.bigAwardValue}}),x=new Date,m=e.filter(e=>!e.redeemed&&new Date(e.expiryDate)<x).length;return{totalAwards:t,redeemedAwards:s,pendingAwards:t-s,totalValue:a,redeemedValue:l,pendingValue:a-l,expiredValue:e.filter(e=>!e.redeemed&&new Date(e.expiryDate)<x).reduce((e,t)=>e+t.value,0),valueDistribution:d,detailedValueStats:n,bankDistribution:i,bankValueDistribution:c,topBigAwardBanks:o,expiredAwards:m}})();return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"澳門消費獎賞記錄器(個人版)"}),(0,t.jsx)("p",{className:"text-gray-600",children:"記錄和管理您的電子優惠券"})]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("div",{className:"flex space-x-1 bg-white p-1 rounded-lg shadow-sm border",children:[(0,t.jsx)("button",{onClick:()=>b("list"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("list"===h?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"獎品記錄"}),(0,t.jsx)("button",{onClick:()=>b("summary"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("summary"===h?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"統計摘要"})]})}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,t.jsx)("button",{onClick:()=>{g(void 0),m(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:"+ 新增獎品"}),(0,t.jsx)("button",{onClick:()=>{try{let t={awards:e,exportDate:new Date().toISOString(),version:"1.0",app:"澳門消費獎賞記錄器"},s=JSON.stringify(t,null,2),a=new Blob([s],{type:"application/json"}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download="macau-spending-rewards-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r),alert("數據已成功導出！")}catch(e){console.error("Export failed:",e),alert("導出失敗，請重試。")}},disabled:0===e.length,className:"px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors ".concat(0===e.length?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),title:0===e.length?"沒有數據可導出":"導出所有獎品數據",children:"📥 導出數據"}),(0,t.jsxs)("label",{className:"bg-orange-600 text-white px-4 py-2 rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 transition-colors cursor-pointer",children:["📤 匯入數據",(0,t.jsx)("input",{type:"file",accept:".json",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(!s)return;let r=new FileReader;r.onload=e=>{try{var t;let s=null==(t=e.target)?void 0:t.result,r=JSON.parse(s);if(!r.awards||!Array.isArray(r.awards))throw Error("無效的數據格式");let l=r.awards.filter(e=>e.id&&void 0!==e.value&&e.drawDate&&e.expiryDate&&e.bank);if(0===l.length)throw Error("沒有找到有效的獎品數據");if(!confirm("確定要匯入 ".concat(l.length," 個獎品記錄嗎？\n\n")+"這將會覆蓋現有的所有數據。\n建議先導出現有數據作為備份。"))return;localStorage.setItem("macau-spending-rewards-awards",JSON.stringify(l)),a(l),alert("成功匯入 ".concat(l.length," 個獎品記錄！"))}catch(e){console.error("Import failed:",e),alert("匯入失敗：".concat(e instanceof Error?e.message:"未知錯誤"))}},r.readAsText(s),e.target.value=""},className:"hidden"})]})]})}),i&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(c,{award:u,onSave:u?e=>{if(u){if(Array.isArray(e)){let t=n(u.id,e[0]);t&&a(e=>e.map(e=>e.id===u.id?t:e))}else{let t=n(u.id,e);t&&a(e=>e.map(e=>e.id===u.id?t:e))}g(void 0),m(!1)}}:e=>{if(Array.isArray(e)){let t=e.map(e=>d(e));a(e=>[...e,...t])}else{let t=d(e);a(e=>[...e,t])}m(!1)},onCancel:()=>{m(!1),g(void 0)},existingAwards:e})})})}),"list"===h?(0,t.jsx)(o,{awards:e,onEdit:e=>{g(e),m(!0)},onDelete:e=>{confirm("確定要刪除這個獎品記錄嗎？")&&(e=>{let t=r(),s=t.filter(t=>t.id!==e);return s.length!==t.length&&(l(s),!0)})(e)&&a(t=>t.filter(t=>t.id!==e))},onToggleRedeemed:t=>{let s=e.find(e=>e.id===t);if(!s)return;let r=n(t,{redeemed:!s.redeemed,redeemedDate:s.redeemed?void 0:new Date().toISOString()});r&&a(e=>e.map(e=>e.id===t?r:e))},onUpdateMerchant:(e,t)=>{let s=n(e,{merchant:t});s&&a(t=>t.map(t=>t.id===e?s:t))}}):(0,t.jsx)(x,{summary:p}),(0,t.jsxs)("div",{className:"mt-12 bg-white p-6 rounded-lg shadow-md border",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"活動資訊"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"活動期間："}),"2025年9月1日 00:00 至 2025年11月30日 23:59"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"電子優惠面值："}),"10、20、50、100 或 200 澳門元"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"兌換期限："}),"獲得後緊接的周六及周日"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"注意："}),"逾期無效，不可轉讓或兌現"]}),(0,t.jsx)("p",{children:"Don’t thank me, give a hug to Grok!"})]})]})]})})}}]);