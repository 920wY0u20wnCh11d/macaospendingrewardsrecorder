(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";e.s(["default",()=>m],52683);var t=e.i(43476),s=e.i(71645);let a="macau-spending-rewards-awards",r=()=>{try{let e=localStorage.getItem(a);if(!e)return[];return JSON.parse(e).map(e=>({...e,bank:e.bank||"螞蟻銀行（澳門）股份有限公司",isThankYou:void 0!==e.isThankYou?e.isThankYou:0===e.value}))}catch(e){return console.error("Error loading awards from localStorage:",e),[]}},l=e=>{try{localStorage.setItem(a,JSON.stringify(e))}catch(e){console.error("Error saving awards to localStorage:",e)}},d=e=>{let t=r(),s={...e,id:Date.now().toString()+Math.random().toString(36).substr(2,9)};return t.push(s),l(t),s},n=(e,t)=>{let s=r(),a=s.findIndex(t=>t.id===e);return -1===a?null:(s[a]={...s[a],...t},l(s),s[a])},i=["螞蟻銀行（澳門）股份有限公司","中國銀行（澳門）股份有限公司","廣發銀行股份有限公司澳門分行","中國工商銀行（澳門）股份有限公司","澳門國際銀行股份有限公司","澳門通股份有限公司","大豐銀行股份有限公司","澳門極易付股份有限公司"];function c(e){let{award:a,onSave:r,onCancel:l}=e,d=()=>({value:10,drawDate:"",expiryDate:"",redeemed:!1,redeemedDate:"",merchant:"",notes:"",bank:i[0],isThankYou:!1}),n=(0,s.useCallback)(e=>{let t=new Date,s=new Date(t),a=t.getDay();0===a?s.setDate(t.getDate()+1):6===a&&s.setDate(t.getDate()+2);let r=s.toISOString().split("T")[0],l=d();return l.drawDate=r,l.expiryDate=u(r),e&&(l.bank=e),l},[]),[c,o]=(0,s.useState)([d()]),[x,m]=(0,s.useState)([""]),u=e=>{let t=new Date(e),s=t.getDay(),a=0;a=0===s?7:6===s?1:7-s;let r=new Date(t);return r.setDate(t.getDate()+a),r.toISOString().split("T")[0]};(0,s.useEffect)(()=>{a?o([{value:a.value,drawDate:a.drawDate.split("T")[0],expiryDate:a.expiryDate.split("T")[0],redeemed:a.redeemed,redeemedDate:a.redeemedDate?a.redeemedDate.split("T")[0]:"",merchant:a.merchant||"",notes:a.notes||"",bank:a.bank||i[0],isThankYou:a.isThankYou||!1}]):o([n()]),m([""])},[a,n]);let g=(e,t,s)=>{let a=[...c];a[e]={...a[e],[t]:s},o(a)};return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md border max-w-4xl mx-auto",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:a?"編輯獎品":"新增獎品"}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),x.some(e=>e))return void alert("請修正日期錯誤後再提交");r(c.map(e=>({value:e.value,drawDate:new Date(e.drawDate).toISOString(),expiryDate:new Date(e.expiryDate).toISOString(),redeemed:e.redeemed,redeemedDate:e.redeemed&&e.redeemedDate?new Date(e.redeemedDate).toISOString():void 0,merchant:e.merchant||void 0,notes:e.notes||void 0,bank:e.bank,isThankYou:e.isThankYou})))},className:"space-y-6",children:[c.map((e,s)=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 relative",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-700",children:["獎品 ",s+1,e.isThankYou&&(0,t.jsx)("span",{className:"ml-2 text-orange-600 font-normal",children:"(謝謝惠顧)"})]}),c.length>1&&(0,t.jsx)("button",{type:"button",onClick:()=>(e=>{if(c.length>1){let t=c.filter((t,s)=>s!==e),s=x.filter((t,s)=>s!==e);o(t),m(s)}})(s),className:"text-red-500 hover:text-red-700 text-sm",children:"移除"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"獎品面值 (MOP)"}),(0,t.jsxs)("select",{value:e.value,onChange:e=>((e,t)=>{let s=[...c];s[e]={...s[e],value:t,isThankYou:0===t},o(s)})(s,parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,t.jsx)("option",{value:0,children:"謝謝惠顧"}),(0,t.jsx)("option",{value:10,children:"10 MOP"}),(0,t.jsx)("option",{value:20,children:"20 MOP"}),(0,t.jsx)("option",{value:50,children:"50 MOP"}),(0,t.jsx)("option",{value:100,children:"100 MOP"}),(0,t.jsx)("option",{value:200,children:"200 MOP"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"承辦單位"}),(0,t.jsx)("select",{value:e.bank,onChange:e=>g(s,"bank",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:i.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"抽獎日期"}),(0,t.jsx)("input",{type:"date",value:e.drawDate,onChange:e=>((e,t)=>{let s=(e=>{let t=new Date(e).getDay();return 0!==t&&6!==t})(t),a=[...x];a[e]=s?"":"抽獎日期不能是星期六或星期日",m(a);let r=u(t),l=[...c];l[e]={...l[e],drawDate:t,expiryDate:r},o(l)})(s,e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(x[s]?"border-red-500":"border-gray-300"),required:!0}),x[s]&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:x[s]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"到期日期"}),(0,t.jsx)("input",{type:"date",value:e.expiryDate,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 cursor-not-allowed",title:"到期日期根據抽獎日期自動計算"}),(0,t.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"根據抽獎日期自動計算"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"商戶名稱"}),(0,t.jsx)("input",{type:"text",value:e.merchant,onChange:e=>g(s,"merchant",e.target.value),placeholder:"可選",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"備註"}),(0,t.jsx)("input",{type:"text",value:e.notes,onChange:e=>g(s,"notes",e.target.value),placeholder:"可選",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-4",children:[(0,t.jsx)("input",{type:"checkbox",id:"redeemed-".concat(s),checked:e.redeemed,onChange:e=>g(s,"redeemed",e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),(0,t.jsx)("label",{htmlFor:"redeemed-".concat(s),className:"text-sm font-medium text-gray-700",children:"已兌換"})]}),e.redeemed&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"兌換日期"}),(0,t.jsx)("input",{type:"date",value:e.redeemedDate,onChange:e=>g(s,"redeemedDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:e.redeemed})]})]},s)),c.length>=1&&!a&&(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("button",{type:"button",onClick:()=>{let e=c[c.length-1];o([...c,n(e?e.bank:void 0)]),m([...x,""])},className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors",children:"+ 添加另一個獎品"})}),(0,t.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:x.some(e=>e),className:"px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors ".concat(x.some(e=>e)?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:a?"更新":"新增 ".concat(c.length," 個獎品")}),(0,t.jsx)("button",{type:"button",onClick:l,className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors",children:"取消"})]})]})]})}function o(e){let{awards:a,onEdit:r,onDelete:l,onToggleRedeemed:d,onUpdateMerchant:n}=e,[i,c]=(0,s.useState)("date"),[o,x]=(0,s.useState)("pending"),[m,u]=(0,s.useState)(null),[g,h]=(0,s.useState)(""),b=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}),p=e=>!e.redeemed&&new Date(e.expiryDate)<new Date,j=a.filter(e=>{switch(o){case"pending":return!e.redeemed;case"redeemed":return e.redeemed;case"expired":return p(e);default:return!0}}).sort((e,t)=>{switch(i){case"date":return new Date(t.drawDate).getTime()-new Date(e.drawDate).getTime();case"value":return t.value-e.value;case"status":if(e.redeemed===t.redeemed)return new Date(t.drawDate).getTime()-new Date(e.drawDate).getTime();return e.redeemed?1:-1;default:return 0}}),y=()=>{u(null),h("")};return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md border",children:[(0,t.jsx)("div",{className:"p-4 border-b",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"獎品記錄"}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,t.jsxs)("select",{value:o,onChange:e=>x(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"all",children:"全部"}),(0,t.jsx)("option",{value:"pending",children:"待兌換"}),(0,t.jsx)("option",{value:"redeemed",children:"已兌換"}),(0,t.jsx)("option",{value:"expired",children:"已過期"})]}),(0,t.jsxs)("select",{value:i,onChange:e=>c(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"date",children:"按日期排序"}),(0,t.jsx)("option",{value:"value",children:"按面值排序"}),(0,t.jsx)("option",{value:"status",children:"按狀態排序"})]})]})]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:0===j.length?(0,t.jsx)("div",{className:"p-8 text-center text-gray-500",children:"all"===o?"還沒有記錄任何獎品":"沒有符合條件的獎品"}):(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"面值"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"承辦單位"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"抽獎日期"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"到期日期"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"商戶"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"狀態"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.isThankYou?(0,t.jsx)("span",{className:"text-orange-600 font-semibold",children:"謝謝惠顧"}):"".concat(e.value," MOP")})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:e.bank,children:e.bank})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm text-gray-900",children:b(e.drawDate)})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm ".concat(p(e)?"text-red-600 font-medium":"text-gray-900"),children:b(e.expiryDate)})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:m===e.id?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"text",value:g,onChange:e=>h(e.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"輸入商戶名稱",autoFocus:!0}),(0,t.jsx)("button",{onClick:()=>{n(e.id,g.trim()||void 0),u(null),h("")},className:"text-green-600 hover:text-green-800 text-sm",title:"保存",children:"✓"}),(0,t.jsx)("button",{onClick:y,className:"text-red-600 hover:text-red-800 text-sm",title:"取消",children:"✕"})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-900",children:e.merchant||"-"}),(0,t.jsx)("button",{onClick:()=>{u(e.id),h(e.merchant||"")},className:"text-blue-600 hover:text-blue-800 text-sm",title:"編輯商戶",children:"✏️"})]})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:e.redeemed?(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"已兌換"}):p(e)?(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-red-100 text-red-800 rounded-full",children:"已過期"}):(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"待兌換"})}),(0,t.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[(0,t.jsx)("button",{onClick:()=>d(e.id),className:"px-2 py-1 rounded text-xs ".concat(e.redeemed?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-green-100 text-green-700 hover:bg-green-200"),children:e.redeemed?"取消兌換":"標記兌換"}),(0,t.jsx)("button",{onClick:()=>r(e),className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs hover:bg-blue-200",children:"編輯"}),(0,t.jsx)("button",{onClick:()=>l(e.id),className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs hover:bg-red-200",children:"刪除"})]})]},e.id))})]})})]})}function x(e){let{summary:s}=e,a=e=>"".concat(e.toLocaleString()," MOP"),r=(e,t)=>t>0?Math.round(e/t*100):0;return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md border",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-6 text-gray-800",children:"獎品統計"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:s.totalAwards}),(0,t.jsx)("div",{className:"text-sm text-blue-800",children:"總獎品數"})]}),(0,t.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:s.redeemedAwards}),(0,t.jsx)("div",{className:"text-sm text-green-800",children:"已兌換"}),(0,t.jsxs)("div",{className:"text-xs text-green-600 mt-1",children:[r(s.redeemedAwards,s.totalAwards),"%"]})]}),(0,t.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:s.pendingAwards}),(0,t.jsx)("div",{className:"text-sm text-yellow-800",children:"待兌換"})]}),(0,t.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:s.expiredAwards}),(0,t.jsx)("div",{className:"text-sm text-red-800",children:"已過期"})]})]}),s.totalAwards>0&&(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"🎯 兌換進度"}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-6 mb-3",children:(0,t.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-6 rounded-full transition-all duration-500 flex items-center justify-center text-white text-sm font-medium",style:{width:"".concat(r(s.redeemedAwards,s.totalAwards),"%")},children:[r(s.redeemedAwards,s.totalAwards),"%"]})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-gray-800 mb-1",children:[s.redeemedAwards," / ",s.totalAwards]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"獎品已兌換"})]})]}),s.topBigAwardBanks.length>0&&(0,t.jsxs)("div",{className:"border-t pt-6 mt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"🏆 大獎機率最高的銀行 TOP 3"}),(0,t.jsx)("div",{className:"space-y-3",children:s.topBigAwardBanks.map((e,s)=>(0,t.jsx)("div",{className:"p-4 rounded-lg border-2 ".concat(0===s?"bg-gradient-to-r from-yellow-50 to-yellow-100 border-yellow-300":1===s?"bg-gradient-to-r from-gray-50 to-gray-100 border-gray-300":"bg-gradient-to-r from-orange-50 to-orange-100 border-orange-300"),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold ".concat(0===s?"bg-yellow-400 text-yellow-900 shadow-lg":1===s?"bg-gray-400 text-white shadow-lg":"bg-orange-400 text-orange-900 shadow-lg"),children:s+1}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold text-gray-800 truncate max-w-xs",title:e.bank,children:e.bank}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["大獎機率: ",(0,t.jsxs)("span",{className:"font-bold text-green-600",children:[e.probability,"%"]})]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-xl font-bold text-gray-800",children:[e.bigAwards,"/",e.totalAwards]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[e.bigAwardValue," MOP"]})]})]})},e.bank))})]}),(0,t.jsxs)("div",{className:"border-t pt-6 mt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"📊 銀行獎品詳情"}),(0,t.jsx)("div",{className:"space-y-4",children:i.map(e=>{let a=s.bankValueDistribution[e];if(!a||0===a.totalAwards)return null;let r=a.bigAwards>0;return(0,t.jsxs)("div",{className:"border rounded-lg p-4 ".concat(r?"border-yellow-300 bg-yellow-50":"border-gray-200 bg-white"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-800 truncate",title:e,children:e}),r&&(0,t.jsx)("span",{className:"text-yellow-600",children:"🎯"})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["總計: ",(0,t.jsx)("span",{className:"font-bold",children:a.totalAwards})," 獎品"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2 mb-3",children:[0,10,20,50,100,200].map(e=>{let s=a.valueBreakdown[e]||0,r=a.totalAwards>0?s/a.totalAwards*100:0;return(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-sm font-medium px-2 py-2 rounded-lg ".concat(0===e?"bg-orange-100 text-orange-800 border border-orange-200":e>=100?"bg-green-100 text-green-800 border border-green-200":"bg-blue-100 text-blue-800 border border-blue-200"),children:0===e?"謝謝惠顧":"".concat(e,"MOP")}),(0,t.jsxs)("div",{className:"text-xs text-gray-600 mt-1 font-medium",children:[s," (",Math.round(r),"%)"]})]},e)})}),(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm border-t pt-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:["大獎機率: ",(0,t.jsxs)("span",{className:"font-bold ".concat(r?"text-green-600":"text-gray-500"),children:[Math.round(100*a.probability)/100,"%"]})]}),(0,t.jsxs)("span",{className:"text-gray-600",children:["總價值: ",(0,t.jsxs)("span",{className:"font-bold text-blue-600",children:[a.totalValue," MOP"]})]})]}),r&&(0,t.jsx)("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"大獎銀行"})]})]},e)})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 border-t pt-6 mt-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-gray-800",children:a(s.totalValue)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"總價值"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-green-600",children:a(s.redeemedValue)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"已兌換價值"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-yellow-600",children:a(s.pendingValue)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"待兌換價值"})]})]}),(0,t.jsxs)("div",{className:"border-t pt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"面值分佈"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[10,20,50,100,200].map(e=>(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-gray-800",children:s.valueDistribution[e]||0}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[e," MOP"]})]},e))})]}),(0,t.jsxs)("div",{className:"border-t pt-6 mt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"承辦單位分佈"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:i.map(e=>{let a=s.bankValueDistribution[e],r=a&&a.bigAwards>0;return(0,t.jsxs)("div",{className:"p-4 rounded-lg ".concat(r?"bg-yellow-50 border-2 border-yellow-300":"bg-gray-50"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-gray-800",children:s.bankDistribution[e]||0}),r&&(0,t.jsx)("span",{className:"text-yellow-600 text-sm font-semibold",children:"🎯"})]}),(0,t.jsx)("div",{className:"text-sm text-gray-600 truncate mb-2",title:e,children:e}),a&&(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,t.jsxs)("div",{children:["大獎: ",a.bigAwards," (",Math.round(100*a.probability)/100,"%)"]}),(0,t.jsxs)("div",{children:["總值: ",a.totalValue," MOP"]})]})]},e)})}),(0,t.jsx)("div",{className:"mt-4 text-sm text-gray-600",children:(0,t.jsxs)("span",{className:"inline-flex items-center",children:[(0,t.jsx)("span",{className:"w-3 h-3 bg-yellow-300 border border-yellow-600 rounded mr-2"}),"提供大獎 (≥100 MOP) 的銀行"]})})]})]})}function m(){let[e,a]=(0,s.useState)([]),[i,m]=(0,s.useState)(!1),[u,g]=(0,s.useState)(),[h,b]=(0,s.useState)("list");(0,s.useEffect)(()=>{a(r())},[]);let p=(()=>{let e=r(),t=e.length,s=e.filter(e=>e.redeemed).length,a=e.reduce((e,t)=>e+t.value,0),l=e.filter(e=>e.redeemed).reduce((e,t)=>e+t.value,0),d=e.reduce((e,t)=>(e[t.value]=(e[t.value]||0)+1,e),{}),n=e.reduce((e,t)=>(e[t.bank]=(e[t.bank]||0)+1,e),{}),i=e.reduce((e,t)=>(e[t.bank]||(e[t.bank]={totalAwards:0,valueBreakdown:{},bigAwards:0,totalValue:0,bigAwardValue:0,probability:0}),e[t.bank].totalAwards+=1,e[t.bank].valueBreakdown[t.value]=(e[t.bank].valueBreakdown[t.value]||0)+1,e[t.bank].totalValue+=t.value,t.value>=100&&(e[t.bank].bigAwards+=1,e[t.bank].bigAwardValue+=t.value),e),{});Object.keys(i).forEach(e=>{let t=i[e];t.probability=t.totalAwards>0?t.bigAwards/t.totalAwards*100:0});let c=Object.entries(i).filter(e=>{let[,t]=e;return t.totalAwards>0}).sort((e,t)=>t[1].probability!==e[1].probability?t[1].probability-e[1].probability:t[1].bigAwards-e[1].bigAwards).slice(0,3).map(e=>{let[t,s]=e;return{bank:t,probability:Math.round(100*s.probability)/100,bigAwards:s.bigAwards,totalAwards:s.totalAwards,bigAwardValue:s.bigAwardValue}}),o=new Date;return{totalAwards:t,redeemedAwards:s,pendingAwards:t-s,totalValue:a,redeemedValue:l,pendingValue:a-l,valueDistribution:d,bankDistribution:n,bankValueDistribution:i,topBigAwardBanks:c,expiredAwards:e.filter(e=>!e.redeemed&&new Date(e.expiryDate)<o).length}})();return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"澳門消費獎賞記錄器(個人版)"}),(0,t.jsx)("p",{className:"text-gray-600",children:"記錄和管理您的電子優惠券"})]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("div",{className:"flex space-x-1 bg-white p-1 rounded-lg shadow-sm border",children:[(0,t.jsx)("button",{onClick:()=>b("list"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("list"===h?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"獎品記錄"}),(0,t.jsx)("button",{onClick:()=>b("summary"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("summary"===h?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"統計摘要"})]})}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("button",{onClick:()=>{g(void 0),m(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:"+ 新增獎品"})}),i&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(c,{award:u,onSave:u?e=>{if(u){if(Array.isArray(e)){let t=n(u.id,e[0]);t&&a(e=>e.map(e=>e.id===u.id?t:e))}else{let t=n(u.id,e);t&&a(e=>e.map(e=>e.id===u.id?t:e))}g(void 0),m(!1)}}:e=>{if(Array.isArray(e)){let t=e.map(e=>d(e));a(e=>[...e,...t])}else{let t=d(e);a(e=>[...e,t])}m(!1)},onCancel:()=>{m(!1),g(void 0)}})})})}),"list"===h?(0,t.jsx)(o,{awards:e,onEdit:e=>{g(e),m(!0)},onDelete:e=>{confirm("確定要刪除這個獎品記錄嗎？")&&(e=>{let t=r(),s=t.filter(t=>t.id!==e);return s.length!==t.length&&(l(s),!0)})(e)&&a(t=>t.filter(t=>t.id!==e))},onToggleRedeemed:t=>{let s=e.find(e=>e.id===t);if(!s)return;let r=n(t,{redeemed:!s.redeemed,redeemedDate:s.redeemed?void 0:new Date().toISOString()});r&&a(e=>e.map(e=>e.id===t?r:e))},onUpdateMerchant:(e,t)=>{let s=n(e,{merchant:t});s&&a(t=>t.map(t=>t.id===e?s:t))}}):(0,t.jsx)(x,{summary:p}),(0,t.jsxs)("div",{className:"mt-12 bg-white p-6 rounded-lg shadow-md border",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"活動資訊"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"活動期間："}),"2025年9月1日 00:00 至 2025年11月30日 23:59"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"電子優惠面值："}),"10、20、50、100 或 200 澳門元"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"兌換期限："}),"獲得後緊接的周六及周日"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"注意："}),"逾期無效，不可轉讓或兌現"]}),(0,t.jsx)("p",{children:"Don’t thank me, give a hug to Grok!"})]})]})]})})}}]);